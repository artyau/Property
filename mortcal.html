<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ  å°ˆæ¥­æŒ‰æ­è¨ˆç®—å™¨ - å®åˆ©é¢¨æ ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ğŸ¨ CSS æ¨£å¼ï¼šæ¨¡æ“¬ Manulife.com.hk çš„å°ˆæ¥­é¢¨æ ¼ */

        :root {
            --primary-color: #003366; /* å®åˆ©æ·±è—è‰² */
            --secondary-color: #00a88f; /* å®åˆ©ç¶ è‰²/è¡Œå‹•å‘¼ç±²è‰² */
            --background-color: #f4f6f9; /* è¼•å¾®ç°çš„èƒŒæ™¯ */
            --card-background: #ffffff;
            --text-color: #333333;
            --border-radius: 6px;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* æŸ”å’Œé™°å½± */
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 40px 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 1100px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 2.5em;
            border-bottom: 3px solid var(--secondary-color); 
            display: inline-block;
            padding-bottom: 8px;
        }
        
        header p {
            color: #555;
        }

        /* è¼¸å…¥èˆ‡çµæœå¡ç‰‡ä½ˆå±€ */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .card {
            background: var(--card-background);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border-top: 5px solid var(--primary-color); /* å¼·èª¿å°ˆæ¥­æ„Ÿ */
        }

        /* --- è¼¸å…¥è¡¨å–®æ¨£å¼ (ä¸¦æ’) --- */

        .input-row {
            display: flex;
            gap: 20px; 
            margin-bottom: 20px;
        }

        .input-row .form-group {
            flex: 1; 
            margin-bottom: 0; 
        }

        .form-group {
            margin-bottom: 20px; 
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 700;
            color: var(--text-color);
            font-size: 1em;
        }

        input[type="number"], .numeric-input {
            width: 100%; 
            padding: 12px;
            border: 1px solid #cccccc;
            border-radius: 4px;
            font-size: 1em;
            transition: border-color 0.3s;
            box-sizing: border-box; 
        }

        input[type="number"]:focus, .numeric-input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(0, 51, 102, 0.25); 
        }

        .input-addon {
            display: flex;
            align-items: center;
        }
        
        .input-addon input {
            flex-grow: 1;
        }

        .input-addon span {
            margin-left: 10px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        /* æŒ‰æ­éŠ€ç¢¼é¡¯ç¤ºæ¨£å¼ */
        .loan-amount-display {
            padding: 12px;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1em; 
            font-weight: 700;
            color: var(--primary-color);
            text-align: right;
            min-height: 20px; 
            box-sizing: border-box; 
            white-space: nowrap; 
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* æŒ‰éˆ•ç¾¤çµ„æ¨£å¼ */
        .button-group {
            display: flex;
            gap: 15px; 
            margin-top: 20px;
        }

        .button-group button {
            flex-grow: 1; 
            padding: 15px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        #calculate-btn {
            background-color: var(--secondary-color); 
            color: white;
        }
        #calculate-btn:hover { background-color: #007f6e; }
        #calculate-btn:active { transform: scale(0.99); }
        
        #clear-btn {
            background-color: #cccccc; 
            color: var(--text-color);
        }
        #clear-btn:hover { background-color: #aaaaaa; }
        #clear-btn:active { transform: scale(0.99); }


        /* --- çµæœé¡¯ç¤ºæ¨£å¼ --- */
        #result-output {
            text-align: center;
            display: none; 
        }

        .monthly-payment-box {
            background-color: #e6f7ff; 
            border: 1px solid var(--primary-color);
            padding: 25px 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .payment-label {
            font-size: 1.2em;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-weight: 400;
        }

        .payment-amount {
            font-size: 3.5em;
            font-weight: 700;
            color: var(--secondary-color); 
            line-height: 1;
        }
        .payment-amount::before {
            content: "HKD "; /* åœ¨é‡‘é¡å‰é¡¯ç¤º HKD */
            font-size: 0.5em;
            vertical-align: top;
            margin-right: 5px;
        }


        /* ç¸½çµæ•¸æ“šè¡Œ (èª¿æ•´ä½ˆå±€ä»¥å¯¦ç¾åˆ†è¡Œé¡¯ç¤º) */
        .summary-item {
            display: flex;
            justify-content: space-between; /* æ¨™ç±¤å’Œé‡‘é¡å·¦å³å°é½Š */
            font-size: 1em;
            padding: 8px 0;
            border-bottom: 1px dashed #eee; /* è¼•å¾®åˆ†éš”ç·š */
        }
        .summary-item:last-child {
            border-bottom: none;
            font-size: 1.1em; /* ç¸½é‚„æ¬¾é¡å¯ä»¥ç¨å¾®å¤§ä¸€é» */
            font-weight: 700;
        }
        .summary-item strong {
            color: var(--primary-color);
            font-weight: 400; /* æ¨™ç±¤å­—é«”ä¸éœ€å¤ªç²— */
        }
        .summary-item span {
            font-weight: 700;
            color: var(--primary-color); /* é‡‘é¡å¼·èª¿ */
        }

        /* è¡¨æ ¼æ¨£å¼ */
        #amortization-schedule {
            display: none; 
            width: 100%;
            overflow-x: auto; 
            margin-top: 30px;
        }
        
        #amortization-schedule h2 {
            color: var(--primary-color);
            border-bottom: 1px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        #schedule-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            box-shadow: var(--shadow); 
        }

        #schedule-table thead {
            background-color: var(--primary-color);
            color: white;
            position: sticky; 
            top: 0;
            z-index: 10;
        }

        #schedule-table th, #schedule-table td {
            padding: 12px 15px;
            text-align: right;
            border: 1px solid #e9ecef; 
        }

        #schedule-table th:first-child, #schedule-table td:first-child {
            text-align: center; 
        }

        #schedule-table tbody tr:nth-child(even) {
            background-color: #f8f8f8; 
        }

        #schedule-table tbody tr:hover {
            background-color: #eef2f5; 
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr; 
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>æŒ‰æ­é‚„æ¬¾è¨ˆç®—å™¨</h1>
            <p>ä½¿ç”¨ç­‰é¡æœ¬æ¯æ³•ï¼Œç²¾æº–è¨ˆç®—æ‚¨çš„æ¯æœˆä¾›æ¬¾èˆ‡åˆ†æœŸæ”¤é‚„è©³æƒ…ã€‚</p>
        </header>

        <div class="main-grid">
            <div class="card input-card">
                <h2>è¼¸å…¥æŒ‰æ­è³‡è¨Š</h2>
                
                <div class="input-row">
                    <div class="form-group">
                        <label for="property-value">ç‰©æ¥­åƒ¹å€¼</label>
                        <input type="text" id="property-value" class="numeric-input" min="100000" required inputmode="numeric" pattern="[0-9,]*">
                    </div>
                    
                    <div class="form-group">
                        <label for="loan-percentage">æŒ‰æ­æˆæ•¸ (%)</label>
                        <div class="input-addon">
                            <input type="number" id="loan-percentage" min="1" max="100" required>
                            <span>%</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>è²¸æ¬¾é¡</label>
                    <div class="loan-amount-display" id="calculated-principal">HKD --</div>
                </div>

                <div class="input-row">
                    <div class="form-group">
                        <label for="loan-term">æŒ‰æ­å¹´æœŸ (å¹´)</label>
                        <div class="input-addon">
                            <input type="number" id="loan-term" min="1" max="50" required>
                            <span>å¹´</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="annual-rate">æŒ‰æ­å¹´åˆ©ç‡ (%)</label>
                        <div class="input-addon">
                            <input type="number" id="annual-rate" min="0.01" step="0.01" required>
                            <span>%</span>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button id="calculate-btn">é–‹å§‹è¨ˆç®—</button>
                    <button id="clear-btn">æ¸…é™¤æ‰€æœ‰</button>
                </div>
            </div>

            <div class="card" id="result-output">
                <h2>è¨ˆç®—çµæœç¸½è¦½</h2>

                <div class="monthly-payment-box">
                    <div class="payment-label">æ¯æœˆä¾›æ¬¾é¡</div>
                    <div class="payment-amount" id="monthly-payment-amount">--</div>
                </div>

                <div style="margin-top: 30px;">
                    <div class="summary-item">
                        <strong>è²¸æ¬¾ç¸½é¡:</strong> 
                        <span id="total-loan-principal">HKD --</span>
                    </div>
                    <div class="summary-item">
                        <strong>é‚„æ¬¾ç¸½åˆ©æ¯:</strong> 
                        <span id="total-interest-paid">HKD --</span>
                    </div>
                    <div class="summary-item">
                        <strong>ç¸½é‚„æ¬¾é¡:</strong> 
                        <span id="total-repayment">HKD --</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="amortization-schedule">
            <h2>æŒ‰æ­åˆ†æœŸæ”¤é‚„è¡¨ (ç´°ç¯€)</h2>
            <table id="schedule-table">
                <thead>
                    <tr>
                        <th>æœŸæ•¸</th>
                        <th>æœŸåˆé¤˜é¡ (HKD)</th>
                        <th>ç¸½ä¾›æ¬¾é¡ (HKD)</th>
                        <th>åˆ©æ¯éƒ¨åˆ† (HKD)</th>
                        <th>æœ¬é‡‘éƒ¨åˆ† (HKD)</th>
                        <th>æœŸæœ«é¤˜é¡ (HKD)</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        // ğŸ’» JavaScript é‚è¼¯ï¼šæŒ‰æ­è¨ˆç®—æ ¸å¿ƒ

        // ç²å–æ‰€æœ‰è¼¸å…¥æ¬„ä½
        const propertyValueInput = document.getElementById('property-value');
        const loanPercentageInput = document.getElementById('loan-percentage');
        const loanTermInput = document.getElementById('loan-term');
        const annualRateInput = document.getElementById('annual-rate');
        
        // ç²å–æŒ‰éˆ•
        const calculateBtn = document.getElementById('calculate-btn');
        const clearBtn = document.getElementById('clear-btn');
        
        // ç²å–çµæœè¼¸å‡ºå€å¡Š
        const resultOutput = document.getElementById('result-output');
        const monthlyPaymentAmount = document.getElementById('monthly-payment-amount');
        const totalLoanPrincipal = document.getElementById('total-loan-principal');
        const totalInterestPaid = document.getElementById('total-interest-paid');
        const totalRepayment = document.getElementById('total-repayment');
        const amortizationSchedule = document.getElementById('amortization-schedule');
        const scheduleTableBody = document.querySelector('#schedule-table tbody');
        const calculatedPrincipalDisplay = document.getElementById('calculated-principal'); 

        /**
         * è§£æå¸¶æœ‰åƒä½åˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²ç‚ºæµ®é»æ•¸
         * @param {string} value å¸¶æœ‰é€—è™Ÿçš„å­—ç¬¦ä¸²
         * @returns {number} è§£æå¾Œçš„æ•¸å­—
         */
        const parseInputNumber = (value) => {
            // ç§»é™¤æ‰€æœ‰é€—è™Ÿï¼Œç„¶å¾Œè§£æç‚ºæµ®é»æ•¸
            const cleanedValue = value.replace(/,/g, '');
            return parseFloat(cleanedValue);
        };
        
        /**
         * æ ¼å¼åŒ–æ•¸å­—ç‚ºåƒä½åˆ†éš”ç¬¦ï¼Œå››æ¨äº”å…¥åˆ°æ•´æ•¸
         * @param {number} num 
         * @returns {string} 
         */
        const formatCurrency = (num) => {
            // ç¢ºä¿è¼¸å…¥æ˜¯æœ‰æ•ˆæ•¸å­—
            if (isNaN(num) || num === null || num === 0) return '0';
            
            // å››æ¨äº”å…¥åˆ°æ•´æ•¸
            const roundedNum = Math.round(num);
            
            // æ ¼å¼åŒ–ç‚ºåƒä½åˆ†éš”ç¬¦
            return roundedNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        };

        /**
         * æ ¼å¼åŒ–æ•¸å­—ç‚º HKD [æ•¸å­—] æ ¼å¼ï¼Œå››æ¨äº”å…¥åˆ°æ•´æ•¸
         * @param {number} num 
         * @returns {string} 
         */
        const formatCurrencyWithHKD = (num) => {
            const formatted = formatCurrency(num);
            // æ³¨æ„ï¼šé€™è£¡åªè¿”å› 'HKD ' + æ•¸å­—ï¼Œå› ç‚º monthly-payment-box çš„ HKD æ˜¯ç”¨ CSS è™•ç†çš„
            return 'HKD ' + formatted; 
        };

        /**
         * æ ¸å¿ƒè¨ˆç®—ï¼šç­‰é¡æœ¬æ¯é‚„æ¬¾æ³•ï¼ˆPMT å…¬å¼ï¼‰
         * @param {number} P - è²¸æ¬¾æœ¬é‡‘ (Principal)
         * @param {number} r - æœˆåˆ©ç‡ (Monthly Interest Rate)
         * @param {number} n - ç¸½æœŸæ•¸ (Total Number of Payments)
         * @returns {number} æ¯æœˆä¾›æ¬¾é¡
         */
        function calculateMonthlyPayment(P, r, n) {
            if (n <= 0) return 0;

            if (r === 0) {
                return P / n;
            }
            // ç­‰é¡æœ¬æ¯å…¬å¼ï¼šM = P [ r(1 + r)^n ] / [ (1 + r)^n â€“ 1 ]
            const power = Math.pow(1 + r, n);
            const monthlyPayment = P * (r * power) / (power - 1);
            return monthlyPayment;
        }

        /**
         * å‡½æ•¸ï¼šè¨ˆç®—ä¸¦é¡¯ç¤ºæŒ‰æ­éŠ€ç¢¼ï¼ˆè²¸æ¬¾æœ¬é‡‘ï¼‰ï¼Œä¸¦åœ¨æ¢ä»¶æ»¿è¶³æ™‚å˜—è©¦è§¸ç™¼ä¸»è¨ˆç®—
         */
        function updateLoanPrincipal() {
            // ç²å–ä¸¦è§£æç‰©æ¥­åƒ¹å€¼ï¼ˆè™•ç†é€—è™Ÿï¼‰
            const propertyValue = parseInputNumber(propertyValueInput.value);
            const loanPercentage = parseFloat(loanPercentageInput.value) / 100;
            
            let principal = 0;

            if (!isNaN(propertyValue) && propertyValue > 0 && 
                !isNaN(loanPercentage) && loanPercentage > 0 && loanPercentage <= 1) {
                
                principal = propertyValue * loanPercentage;
            }

            // æŒ‰æ­éŠ€ç¢¼å³æ™‚é¡¯ç¤º
            calculatedPrincipalDisplay.textContent = formatCurrencyWithHKD(principal);
            
            // å¦‚æœæ‰€æœ‰æ ¸å¿ƒè¼¸å…¥éƒ½æœ‰æ•ˆï¼Œå‰‡è§¸ç™¼ä¸»è¨ˆç®—
            const loanTermYears = parseFloat(loanTermInput.value);
            const annualRate = parseFloat(annualRateInput.value);
            
            if (principal > 0 && loanTermYears > 0 && annualRate >= 0) {
                calculateBtn.click();
            } else if (principal <= 0 && resultOutput.style.display !== 'none') {
                // å¦‚æœæœ¬é‡‘ç„¡æ•ˆï¼Œä¸”çµæœå€é‚„åœ¨é¡¯ç¤ºï¼Œå‰‡éš±è—çµæœå€
                 resetResultDisplay();
            }
        }
        
        /**
         * é¡¯ç¤ºçµæœå€å¡Šçš„åˆå§‹ç‹€æ…‹
         */
        function resetResultDisplay() {
            monthlyPaymentAmount.textContent = '--';
            totalLoanPrincipal.textContent = 'HKD --';
            totalInterestPaid.textContent = 'HKD --';
            totalRepayment.textContent = 'HKD --';
            scheduleTableBody.innerHTML = '';
            
            // éš±è—çµæœå€å’Œåˆ†æœŸæ”¤é‚„è¡¨
            resultOutput.style.display = 'none';
            amortizationSchedule.style.display = 'none';
        }


        /**
         * ç¶å®šè¨ˆç®—æŒ‰éˆ•äº‹ä»¶
         */
        calculateBtn.addEventListener('click', () => {
            // 1. ç²å–ä¸¦è™•ç†è¼¸å…¥åƒæ•¸ (æ³¨æ„ propertyValue æ˜¯è§£æå‡ºä¾†çš„)
            const propertyValue = parseInputNumber(propertyValueInput.value); 
            const loanPercentage = parseFloat(loanPercentageInput.value) / 100;
            const loanTermYears = parseFloat(loanTermInput.value);
            const annualRate = parseFloat(annualRateInput.value) / 100;

            // åƒæ•¸æª¢æŸ¥
            if (isNaN(propertyValue) || isNaN(loanPercentage) || isNaN(loanTermYears) || isNaN(annualRate) || 
                propertyValue <= 0 || loanTermYears <= 0 || loanPercentage <= 0 || annualRate < 0) {
                
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„æŒ‰æ­åƒæ•¸ï¼(ç‰©æ¥­åƒ¹å€¼ã€æŒ‰æ­æˆæ•¸å’Œå¹´æœŸå¿…é ˆå¤§æ–¼ 0)');
                resetResultDisplay(); 
                calculatedPrincipalDisplay.textContent = 'HKD --';
                return;
            }

            // æ›ç®—æˆè¨ˆç®—æ‰€éœ€å–®ä½
            const principal = propertyValue * loanPercentage; // è²¸æ¬¾æœ¬é‡‘ (P)
            const monthlyRate = annualRate / 12; // æœˆåˆ©ç‡ (r)
            const totalPayments = loanTermYears * 12; // ç¸½æœˆæ•¸ (n)
            
            // 2. è¨ˆç®—æ¯æœˆä¾›æ¬¾é¡
            const monthlyPayment = calculateMonthlyPayment(principal, monthlyRate, totalPayments);

            // 3. ç”Ÿæˆåˆ†æœŸæ”¤é‚„è¡¨ä¸¦è¨ˆç®—ç¸½åˆ©æ¯
            let remainingBalance = principal;
            let totalInterest = 0;
            scheduleTableBody.innerHTML = ''; 

            for (let month = 1; month <= totalPayments; month++) {
                const startBalance = remainingBalance;
                
                const interestPayment = startBalance * monthlyRate;
                totalInterest += interestPayment;
                
                let principalPayment = monthlyPayment - interestPayment;

                // ä¿®æ­£æœ€å¾Œä¸€æœŸè¨ˆç®—èª¤å·®
                if (month === totalPayments) {
                    principalPayment = startBalance; 
                    remainingBalance = 0;
                } else {
                    remainingBalance -= principalPayment;
                }

                if (remainingBalance < 0 && month === totalPayments) {
                    remainingBalance = 0;
                }
                
                // å‰µå»ºè¡¨æ ¼è¡Œ (tr)
                const row = scheduleTableBody.insertRow();
                
                // æ‰€æœ‰é‡‘é¡éƒ½ä½¿ç”¨ formatCurrency() é€²è¡Œå››æ¨äº”å…¥åˆ°æ•´æ•¸
                row.insertCell(0).textContent = month; 
                row.insertCell(1).textContent = formatCurrency(startBalance); 
                row.insertCell(2).textContent = formatCurrency(monthlyPayment); 
                row.insertCell(3).textContent = formatCurrency(interestPayment); 
                row.insertCell(4).textContent = formatCurrency(principalPayment); 
                row.insertCell(5).textContent = formatCurrency(remainingBalance); 
            }

            // 4. é¡¯ç¤ºçµæœç¸½çµ (æ‰€æœ‰çµæœä½¿ç”¨ HKD å‰ç¶´)
            const totalRepay = principal + totalInterest;

            // æ¯æœˆä¾›æ¬¾é¡ (HKD ç”± CSS æ§åˆ¶)
            monthlyPaymentAmount.textContent = formatCurrency(monthlyPayment);
            
            // ä¸‰é …ç¨ç«‹é¡¯ç¤ºçš„çµæœ
            totalLoanPrincipal.textContent = formatCurrencyWithHKD(principal);
            totalInterestPaid.textContent = formatCurrencyWithHKD(totalInterest);
            totalRepayment.textContent = formatCurrencyWithHKD(totalRepay);

            // é¡¯ç¤ºçµæœå€å’Œè¡¨æ ¼
            resultOutput.style.display = 'block';
            amortizationSchedule.style.display = 'block';
            
            // ç¢ºä¿å³æ™‚éŠ€ç¢¼ä¹Ÿæ›´æ–°åˆ°æœ€çµ‚çµæœ
            calculatedPrincipalDisplay.textContent = formatCurrencyWithHKD(principal); 
        });
        
        /**
         * ç¶å®šæ¸…é™¤æŒ‰éˆ•äº‹ä»¶ï¼šæ¸…é™¤æ‰€æœ‰è¼¸å…¥æ¬„ä½å’Œçµæœé¡¯ç¤º
         */
        clearBtn.addEventListener('click', () => {
            // æ¸…ç©ºæ‰€æœ‰è¼¸å…¥æ¬„ä½
            propertyValueInput.value = '';
            loanPercentageInput.value = '';
            loanTermInput.value = '';
            annualRateInput.value = '';

            // é‡è¨­æŒ‰æ­éŠ€ç¢¼é¡¯ç¤º
            calculatedPrincipalDisplay.textContent = 'HKD --';

            // é‡è¨­çµæœé¡¯ç¤ºå€å¡Š
            resetResultDisplay();

            propertyValueInput.focus();
        });
        
        /**
         * è™•ç†ç‰©æ¥­åƒ¹å€¼è¼¸å…¥ï¼šè‡ªå‹•åŠ å…¥é€—è™Ÿ
         */
        propertyValueInput.addEventListener('keyup', (e) => {
            // 1. ç§»é™¤é€—è™Ÿä¸¦è§£ææ•¸å­—
            let value = propertyValueInput.value.replace(/,/g, '');
            let number = parseInt(value, 10);

            // 2. å¦‚æœä¸æ˜¯æœ‰æ•ˆçš„æ•¸å­—æˆ–æ²’æœ‰è¼¸å…¥ï¼Œå‰‡æ¸…ç©º
            if (isNaN(number) || value === '') {
                propertyValueInput.value = value;
            } else {
                // 3. é‡æ–°æ ¼å¼åŒ–ä¸¦é¡¯ç¤º
                propertyValueInput.value = number.toLocaleString('en-US');
            }
            
            // è§¸ç™¼ä¸»è¨ˆç®—æ›´æ–°
            updateLoanPrincipal();
        });
        
        // ç¶å®šå…¶ä»–è¼¸å…¥çš„å³æ™‚æ›´æ–°äº‹ä»¶
        loanPercentageInput.addEventListener('input', updateLoanPrincipal);
        loanTermInput.addEventListener('input', updateLoanPrincipal); 
        annualRateInput.addEventListener('input', updateLoanPrincipal); 


        // é é¢è¼‰å…¥æ™‚é‡è¨­æ‰€æœ‰é¡¯ç¤º
        window.onload = () => {
            resetResultDisplay();
            calculatedPrincipalDisplay.textContent = 'HKD --'; 
        };
    </script>
</body>
</html>
